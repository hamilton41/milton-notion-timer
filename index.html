<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Clean Timer</title>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    /* å…¨åŸŸè¨­å®š */
    * {
      box-sizing: border-box;
      user-select: none; /* é˜²æ­¢ä¸€ç›´é¸å–åˆ°æ–‡å­— */
    }

    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      /* é—œéµï¼šèƒŒæ™¯é€æ˜ */
      background-color: transparent;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      overflow: hidden;
    }

    .container {
      text-align: center;
      width: 100%;
    }

    /* æ™‚é–“é¡¯ç¤ºå€ (ä¹Ÿæ˜¯è¼¸å…¥å€) */
    .time-wrapper {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 20px;
      /* ä½¿ç”¨ç­‰å¯¬å­—é«”ï¼Œæ•¸å­—æ‰ä¸æœƒè·³ä¾†è·³å» */
      font-family: 'Courier New', Courier, monospace;
      font-weight: 600; /* ç¨å¾®ç²—ä¸€é»é» */
      color: #37352f; /* Notion é»‘ */
    }

    /* éš±è—è¼¸å…¥æ¡†åŸæœ¬çš„æ¨£å­ï¼Œè®“å®ƒçœ‹èµ·ä¾†åƒç´”æ–‡å­— */
    .time-wrapper input {
      background: transparent;
      border: none;
      font-size: 4.5rem; /* è¶…å¤§å­—é«” */
      width: 2ch; /* å¯¬åº¦å›ºå®šç‚º2å€‹å­—å…ƒ */
      text-align: center;
      font-family: inherit; /* ç¹¼æ‰¿ä¸Šé¢çš„ç­‰å¯¬å­—é«” */
      font-weight: inherit;
      color: inherit;
      padding: 0;
      outline: none;
      cursor: text;
      border-radius: 4px;
      transition: background 0.2s;
    }

    /* æ»‘é¼ ç§»éå»æ™‚ï¼Œçµ¦ä¸€é»é»æç¤º */
    .time-wrapper input:hover:not(:disabled) {
      background: rgba(0, 0, 0, 0.05);
    }

    /* è¼¸å…¥æ™‚çš„æ¨£å­ */
    .time-wrapper input:focus {
      background: rgba(0, 0, 0, 0.1);
    }

    /* ç¦ç”¨æ™‚ (é–‹å§‹è¨ˆæ™‚å¾Œ) */
    .time-wrapper input:disabled {
      cursor: default;
      opacity: 1; /* ä¿æŒæ¸…æ™° */
      background: transparent;
    }

    /* å†’è™Ÿåˆ†éš”ç¬¦ */
    .separator {
      font-size: 4rem;
      margin: 0 5px;
      padding-bottom: 10px; /* å¾®èª¿å°é½Š */
    }

    /* æŒ‰éˆ•å€åŸŸ */
    .controls {
      display: flex;
      justify-content: center;
      gap: 10px;
    }

    button {
      background: white;
      border: 1px solid #e1e1e1;
      padding: 9px 18px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      color: #555;
      transition: all 0.2s;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      line-height: 1;
    }

    button:hover {
      background: #f7f7f7;
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      color: #333;
    }

    button:active {
      transform: translateY(0);
    }

    button i {
      margin-right: 8px;
      opacity: 0.95;
    }

    /* Start/Pauseï¼šèˆ’æœçš„ä½å°æ¯”ç¶ /ç´… */
    #startPauseBtn.is-start {
      background: #f3fbf6;        /* å¾ˆæ·¡çš„ç¶ åº• */
      border-color: #cfe9d7;      /* æŸ”å’Œç¶ é‚Š */
      color: #2f6f4e;             /* æ·±ç¶ å­— */
      font-weight: 600;
    }

    #startPauseBtn.is-start:hover {
      background: #eaf7f0;
      border-color: #bfe0cb;
    }

    #startPauseBtn.is-pause {
      background: #fff3f4;        /* å¾ˆæ·¡çš„ç´…åº• */
      border-color: #f2c6c9;      /* æŸ”å’Œç´…é‚Š */
      color: #8a2f3a;             /* æ·±ç´…å­— */
      font-weight: 600;
    }

    #startPauseBtn.is-pause:hover {
      background: #ffe9eb;
      border-color: #eeb7bd;
    }

    /* Done ç‹€æ…‹ï¼ˆä¸­æ€§ç°ï¼Œé¿å…å¤ªè·³ï¼‰ */
    #startPauseBtn.is-done {
      background: #f6f6f6;
      border-color: #e6e6e6;
      color: #666;
      font-weight: 600;
      cursor: default;
    }

    /* --- Modal (ç¢ºèªè¦–çª—) --- */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.8); /* åŠé€æ˜ç™½åº• */
      backdrop-filter: blur(2px); /* æ¨¡ç³ŠèƒŒæ™¯ */
      align-items: center;
      justify-content: center;
      z-index: 100;
      animation: fadeIn 0.2s;
    }

    .modal-overlay.show {
      display: flex;
    }

    .modal {
      background: white;
      padding: 25px 40px;
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
      border: 1px solid #eee;
    }

    .modal h3 {
      margin: 0 0 20px 0;
      font-size: 1.1rem;
      font-weight: normal;
      color: #333;
    }

    .modal-buttons {
      display: flex;
      gap: 10px;
      justify-content: center;
    }

    .btn-danger {
      color: #a53b44;
      border-color: #f2c6c9;
      background: #fff3f4;
      font-weight: 600;
    }

    .btn-danger:hover {
      background: #ffe9eb;
    }

    .btn-success {
      color: #2f6f4e;
      border-color: #cfe9d7;
      background: #f3fbf6;
      font-weight: 600;
    }

    .btn-success:hover {
      background: #eaf7f0;
      border-color: #bfe0cb;
    }

    /* å®Œæˆ Modal ç‰¹æ®Šæ¨£å¼ */
    .done-modal {
      padding: 30px 50px;
    }

    .done-icon {
      font-size: 3rem;
      margin-bottom: 15px;
    }

    .done-modal h3 {
      font-size: 1.2rem;
      font-weight: 500;
    }

    /* å»æ‰è¼¸å…¥æ¡†çš„ä¸Šä¸‹ç®­é ­ (Chrome/Safari) */
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    /* å»æ‰è¼¸å…¥æ¡†çš„ä¸Šä¸‹ç®­é ­ (Firefox) */
    /* input[type=number] {
      -moz-appearance: textfield;
    } */

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  </style>
</head>
<body>

  <div class="container">
    <div class="time-wrapper">
      <input type="number" id="hours" min="0" max="99" value="00" onfocus="this.select()">
      <span class="separator">:</span>
      <input type="number" id="minutes" min="0" max="59" value="15" onfocus="this.select()">
      <span class="separator">:</span>
      <input type="number" id="seconds" min="0" max="59" value="00" onfocus="this.select()">
    </div>

    <div class="controls">
      <button id="startPauseBtn" class="is-start">
        <i class="fa-solid fa-play"></i>
        <span>Start</span>
      </button>

      <button id="resetBtn">
        <i class="fa-solid fa-rotate-left"></i>
        <span>Reset</span>
      </button>
    </div>
  </div>

  <!-- Reset ç¢ºèª Modal -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal">
      <h3>é‡ç½®è¨ˆæ™‚å™¨ï¼Ÿ</h3>
      <div class="modal-buttons">
        <button class="btn-danger" id="confirmReset">
          <i class="fa-solid fa-trash-can"></i>
          <span>ç¢ºå®š</span>
        </button>
        <button id="cancelReset">
          <i class="fa-solid fa-xmark"></i>
          <span>å–æ¶ˆ</span>
        </button>
      </div>
    </div>
  </div>

  <!-- å®Œæˆ Modal -->
  <div class="modal-overlay" id="doneModalOverlay">
    <div class="modal done-modal">
      <div class="done-icon">ğŸ‰</div>
      <h3>æ­å–œå®Œæˆä»Šæ—¥çš„å°ˆæ³¨ Workï¼</h3>
      <div class="modal-buttons">
        <button class="btn-success" id="doneConfirm">
          <i class="fa-solid fa-check"></i>
          <span>çµæŸ</span>
        </button>
      </div>
    </div>
  </div>

  <!-- å®ŒæˆéŸ³æ•ˆ -->
  <audio id="doneSound" loop>
    <source src="new-notification-026-380249.mp3" type="audio/mpeg">
  </audio>

  <script>
    const startPauseBtn = document.getElementById('startPauseBtn');
    const resetBtn = document.getElementById('resetBtn');
    const hoursInput = document.getElementById('hours');
    const minutesInput = document.getElementById('minutes');
    const secondsInput = document.getElementById('seconds');
    const inputs = [hoursInput, minutesInput, secondsInput];

    const modalOverlay = document.getElementById('modalOverlay');
    const confirmReset = document.getElementById('confirmReset');
    const cancelReset = document.getElementById('cancelReset');

    const doneModalOverlay = document.getElementById('doneModalOverlay');
    const doneConfirm = document.getElementById('doneConfirm');
    const doneSound = document.getElementById('doneSound');

    let totalSeconds = 0;
    let timerId = null;
    let isRunning = false;

    function setStartPauseUI(state) {
      // state: 'start' | 'pause' | 'done'
      startPauseBtn.classList.remove('is-start', 'is-pause', 'is-done');
      startPauseBtn.classList.add(`is-${state}`);

      const icon = startPauseBtn.querySelector('i');
      const label = startPauseBtn.querySelector('span');

      if (state === 'start') {
        icon.className = 'fa-solid fa-play';
        label.textContent = 'Start';
        startPauseBtn.disabled = false;
      } else if (state === 'pause') {
        icon.className = 'fa-solid fa-pause';
        label.textContent = 'Pause';
        startPauseBtn.disabled = false;
      } else if (state === 'done') {
        icon.className = 'fa-solid fa-check';
        label.textContent = 'Done';
        startPauseBtn.disabled = true; // Done å°±ä¸è®“æŒ‰ï¼Œé¿å…ç‹€æ…‹æ€ªæ‰
      }
    }

    // è£œé›¶å‡½æ•¸ (è®“ 5 è®Šæˆ 05)
    function pad(num) {
      return num.toString().padStart(2, '0');
    }

    // æ ¼å¼åŒ–é¡¯ç¤º (åŒæ­¥æ›´æ–°è¼¸å…¥æ¡†çš„å€¼)
    function updateDisplay(h, m, s) {
      hoursInput.value = pad(h);
      minutesInput.value = pad(m);
      secondsInput.value = pad(s);
    }

    // å¾è¼¸å…¥æ¡†å–å¾—ç¸½ç§’æ•¸
    function getInputTime() {
      const h = parseInt(hoursInput.value) || 0;
      const m = parseInt(minutesInput.value) || 0;
      const s = parseInt(secondsInput.value) || 0;
      return h * 3600 + m * 60 + s;
    }

    // é–å®šæˆ–è§£é–è¼¸å…¥æ¡†
    function setInputsDisabled(disabled) {
      inputs.forEach(input => input.disabled = disabled);
    }

    // ç•¶è¼¸å…¥æ¡†æ”¹è®Šæ™‚ï¼Œè‡ªå‹•è£œé›¶ (å¤±å»ç„¦é»æ™‚)
    inputs.forEach(input => {
      input.addEventListener('change', function() {
        let val = parseInt(this.value);
        if (isNaN(val) || val < 0) val = 0;
        // åˆ†é˜å’Œç§’æ•¸ä¸èƒ½è¶…é 59 (é›–ç„¶ HTML æœ‰ min/maxï¼Œä½†æ‰‹æ‰“é‚„æ˜¯è¦é˜²å‘†)
        if (this.id !== 'hours' && val > 59) val = 59;
        this.value = pad(val);
      });

      // æŒ‰ Enter éµè‡ªå‹•é–‹å§‹
      input.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
          startPauseBtn.click();
          startPauseBtn.focus(); // ç§»é™¤ç„¦é»ï¼Œé¿å…ç¹¼çºŒè¼¸å…¥
        }
      });
    });

    function start() {
      // å¦‚æœé‚„æ²’é–‹å§‹è·‘ï¼Œå…ˆè®€å–ç•¶å‰è¼¸å…¥çš„æ™‚é–“
      if (!isRunning && !timerId) {
        totalSeconds = getInputTime();
      }

      if (totalSeconds <= 0) return;

      isRunning = true;
      setStartPauseUI('pause');
      setInputsDisabled(true); // é–å®šè¼¸å…¥

      timerId = setInterval(() => {
        if (totalSeconds > 0) {
          totalSeconds--;

          const h = Math.floor(totalSeconds / 3600);
          const m = Math.floor((totalSeconds % 3600) / 60);
          const s = totalSeconds % 60;
          updateDisplay(h, m, s);
        } else {
          // æ™‚é–“åˆ°
          pause();
          setStartPauseUI('done');
          // é¡¯ç¤ºå®Œæˆ Modal ä¸¦æ’­æ”¾éŸ³æ¨‚
          doneModalOverlay.classList.add('show');
          doneSound.currentTime = 0;
          doneSound.play();
        }
      }, 1000);
    }

    function pause() {
      isRunning = false;
      setStartPauseUI('start');
      clearInterval(timerId);
      timerId = null;
    }

    function reset() {
      pause();
      updateDisplay(0, 15, 0);
      setInputsDisabled(false);
      setStartPauseUI('start');
    }

    // æŒ‰éˆ•ç›£è½
    startPauseBtn.addEventListener('click', () => {
      if (isRunning) {
        pause();
      } else {
        start();
      }
    });

    // Modal é‚è¼¯
    resetBtn.addEventListener('click', () => {
      // åªæœ‰åœ¨é‹ä½œä¸­æˆ–æœ‰æ™‚é–“æ™‚æ‰éœ€è¦ç¢ºèª
      if (timerId || getInputTime() > 0) {
        modalOverlay.classList.add('show');
      } else {
        reset(); // å·²ç¶“æ˜¯æ­¸é›¶ç‹€æ…‹å°±ç›´æ¥é‡ç½®
      }
    });

    confirmReset.addEventListener('click', () => {
      modalOverlay.classList.remove('show');
      reset();
    });

    cancelReset.addEventListener('click', () => {
      modalOverlay.classList.remove('show');
    });

    modalOverlay.addEventListener('click', (e) => {
      if (e.target === modalOverlay) {
        modalOverlay.classList.remove('show');
      }
    });

    // éŸ³æ¨‚æ·¡å‡ºå‡½æ•¸
    function fadeOutAudio(audio, duration = 1000) {
      const startVolume = audio.volume;
      const steps = 20;
      const stepTime = duration / steps;
      const volumeStep = startVolume / steps;

      const fadeInterval = setInterval(() => {
        if (audio.volume > volumeStep) {
          audio.volume -= volumeStep;
        } else {
          audio.volume = 0;
          audio.pause();
          audio.currentTime = 0;
          audio.volume = startVolume; // é‚„åŸéŸ³é‡ä¾›ä¸‹æ¬¡ä½¿ç”¨
          clearInterval(fadeInterval);
        }
      }, stepTime);
    }

    // å®Œæˆ Modal é‚è¼¯
    doneConfirm.addEventListener('click', () => {
      doneModalOverlay.classList.remove('show');
      fadeOutAudio(doneSound, 1000); // 1 ç§’æ·¡å‡º
      reset();
    });

    // åˆå§‹åŒ–ä¸€æ¬¡æ ¼å¼
    updateDisplay(0, 15, 0);
    setStartPauseUI('start');
  </script>
</body>
</html>
